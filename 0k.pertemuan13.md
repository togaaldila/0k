# Pertemuan ke 13 : Praktik Sensor Ultrasonic PIR LDR


## Topik Bahasan
Proyek Dasar Internet of Things I (Praktik Pemrograman Mikrokontroler, Praktik Sensor: Sensor DHT, LCD, Praktik Sensor: Ultrasonic, PIR, dan LDR, Praktik Aktuator: LED dan Relay, Praktik Aktuator: Buzzer dan Servo)

## Deskripsi
- Mampu melakukan instalasi, memahami bahasa pemrograman dan pin pada Arduino. 
- Mampu melakukan uji coba serial monitor dan uji coba PWM dengan potensiometer.
- Mampu merancang dan membuat proyek menggunakan sensor DHT22.
- Mampu merancang dan membuat proyek menggunakan sensor Ultrasonic, PIR, dan LDR.
- Mampu merancang dan membuat proyek menggunakan aktuator LED dan Relay.
- Mampu merancang dan membuat proyek menggunakan aktuator Buzzer dan Servo.

## Teori Singkat

### Sensor Ultrasonic

Sensor ultrasonik adalah sebuah sensor yang berfungsi untuk mengubah besaran fisis (bunyi/gelombang ultrasonik) menjadi besaran listrik dan sebaliknya. 

Sensor ultrasonik dapat digunakan untuk mengukur jarak dengan suatu benda tertentu.

Gelombang ultrasonik adalah gelombang bunyi yang mempunyai frekuensi sangat tinggi yaitu 20.000 Hz. Bunyi ultrasonik tidak dapat di dengar oleh telinga manusia. Bunyi ultrasonik dapat didengar oleh anjing, kucing, kelelawar, dan lumba-lumba. Bunyi ultrasonik nisa merambat melalui zat padat, cair dan gas. 

![img.png](img.png)  

Cara kerja sensor ini didasarkan pada prinsip dari pantulan suatu gelombang suara sehingga dapat dipakai untuk menafsirkan eksistensi (jarak) suatu benda dengan frekuensi tertentu.

![img2.png](img2.png) 

Dengan rumus sebagai berikut:
S =  jarak (cm)
T = waktu (detik) 

![img1.png](img1.png) 

Dimana:
+ S = adalah jarak antara sensor dengan benda yang diukur (m).
+ t = adalah waktu yang dibutuhkan sinyal untuk kembali ke sensor (s).
+ 340 = adalah kecepatan dari gelombang suara (340 m/s)
+ 2 = adalah faktor pembagi jarak karena gelombang suara mengalami pemantulan

Sensor ultrasonik HC-SR04 menggunakan sonar untuk menentukan jarak suatu objek. 

Sensor ini dapat membaca dari 2 cm hingga 400 cm (0,8 inci hingga 157 inci) dengan akurasi 0,3 cm (0,1 inci).

Selain itu, modul khusus ini dilengkapi dengan modul pemancar dan penerima ultrasonik.

![img3.png](img3.png)


**Spesifikasi sensor HC-SR04**

| Nama                 | Nilai                         |
| -------------------- | ----------------------------- |
| Tegangan             | 3,3 V - 5,5 V                 |
| Arus                 | 15 mA                         |
| Frekuensi            | 40 kHz                        |
| Jangkauan minimal    | 2 cm                          |
| Jangkauan maksimal   | 4 meter                       |
| Sudut pengukuruan    | 15º                           |
| Toleransi            | 0,3 cm                        |

Pinout dari sensor ultrasonik adalah sebagai berikut

![img4.png](img4.png)


### Sensor PIR
**Sensor PIR (Passive Infra Red)** merupakan sensor yang memanfaatkan pancaran gelombang inframerah yang dipancarkan oleh benda sekitar. Dengan demikian, sensor ini dapat mengetahui adanya pergerakan yang ada di depannya.

Jangkauan sensor PIR dengan objek maksimal 12m dengan sudut sebaran 60 derajat.

![img6.png](img6.png)

**Cara kerjanya sensor PIR** yaitu pyroelectric pada sensor menerima gelombang inframerah dari benda sekitar dan menghasilkan arus listrik. Untuk memastikan yang dibaca adalah benar-benar gerakan, terdapat komparator untuk membandingkan dengan gelombang lain yang diterima. Jika terdapat perbedaan, maka output sensor akan mengeluarkan tegangan listrik.

![img7.png](img7.png)


### Sensor Cahaya
**Sensor PIR (Passive Infra Red)** Sensor cahaya atau LDR (Light Dependent Resistor) pada dasarnya adalah sebuah komponen yang memiliki resistansi yang dapat berubah ubah sesuai dengan cahaya yang diterima. Sensor ini memiliki 2 kaki yang tidak berpolaritas, sehingga pemasangan boleh terbalik.


![img8.png](img8.png)

Sensor ini akan meningkat resistansi atau hambatannya apabila cahaya yang diterima sedikit. Sebaliknya, apabila cahaya yang diterima banyak maka resistansinya akan mengecil.

Cara mengecek/mengukur sensor ini adalah dengan multimeter dan mengatur pada posisi Ohm. Saat mendapatkan cahaya terang resistansi akan berkurang disbanding dengan tidak mendapatkan cahaya. Sensor ini dapat dimanfaatkan untuk saklar lampu otomatis.

![img12.png](img12.png) 


## Praktikum 1: Arduino dan Sensor Ultrasonic dengan Wokwi

Selesaikan langkah-langkah praktikum berikut ini menggunakan Wokwi di browser Anda.

1. Masuk ke Wokwi. Klik New Projects untuk membuat projek baru. Pilih Arduino UNO.

![img5.png](img5.png) 

2. Tambahkan komponen baru dengan klik Add (+). Tambahkan HC-SR04 Sensor Ultrasonik

![img9.png](img9.png) 

3. Hubungkan seluruh komponen sebagai berikut.
- VCC -> 5V
- Trig -> 3
- Echo -> 2
- Gnd -> GND

![img10.png](img10.png) 

   
4. Tambahkan kode program.Program tersebut digunakan untuk menampilkan hasil pembacaan data sensor ultrasonik. Hasil pembacaan ditampilkan di serial monitor. Jalankan simulasi dengan kllik Start Simulation.


```cpp
#define ECHO_PIN 2
#define TRIG_PIN 3

void setup(){
  Serial.begin(115200);
  pinMode(LED_BUILTIN, OUTPUT);
  pinMode(TRIG_PIN, OUTPUT);
  pinMode(ECHO_PIN, INPUT);
}

float readDistanceCM(){
  digitalWrite(TRIG_PIN, LOW);
  delayMicroseconds(2);
  digitalWrite(TRIG_PIN, HIGH);
  delayMicroseconds(10);
  digitalWrite(TRIG_PIN, LOW);
  int duration = pulseIn(ECHO_PIN,HIGH);
  return duration * 0.034 / 2;
}

void loop(){
   digitalWrite(TRIG_PIN, LOW);
  delayMicroseconds(2);
  digitalWrite(TRIG_PIN, HIGH);
  delayMicroseconds(10);
  digitalWrite(TRIG_PIN, LOW);
  int duration = pulseIn(ECHO_PIN,HIGH);
  float distance = duration * 0.034 / 2;

Serial.print("Jarak: ");
Serial.println(readDistanceCM());
}
```

5. Klik Serial Monitor (bawah) untuk melihat hasil pembacaan sensor. Ubah jarak dengan klik pada sensor, lakukan pengubahan jarak. Jika jarak berhasil muncul, berarti pembacaan data sensor sudah berhasil. Klik Stop simulation untuk menghentikan simulasi

![img11.png](img11.png) 



### Praktikum 2: Praktik LCD, DHT Arduino dengan Wokwi

Selesaikan langkah-langkah praktikum berikut ini menggunakan Wokwi di browser Anda.

1. Masuk ke Wokwi. Klik New Projects untuk membuat projek baru. Pilih Arduino UNO.

![img1.png](img1.png) 

2. Tambahkan library “LiquidCrystal I2C” pada Library Manager. Pastikan library sudah muncul pada Project Libraries.

![img5.png](img5.png)

3. Tambahkan kode program seperti berikut. Pastikan SDA(A4) dan SCL(A5) sudah sesuai.

![img6.png](img6.png)

![img7.png](img7.png)

4. Jalankan simulasi program dengan klik Run. Untuk menampilkan data pada sebuah LCD diwakili dengan baris dan kolom, yang dimulai dari baris ke 0 dan kolom ke 0. Banyaknya data yang bisa ditampilkan tergantung dari spesifikasi LCD, misalkan 16x2 berarti hanya bisa menampilkan 32 digit atau karakter. Klik Stop simulation untuk menghentikan simulasi

![img8.png](img8.png)

### Praktikum 3: Praktik RTC, LCD, DHT Arduino dengan Wokwi

Selesaikan langkah-langkah praktikum berikut ini menggunakan Wokwi di browser Anda.

1. Masuk ke Wokwi. Klik New Projects untuk membuat projek baru. Pilih Arduino UNO.

![img1.png](img1.png) 

2. Tambahkan library “DS1307RTC dan RTClib” pada Library Manager. Pastikan library sudah muncul pada Project Libraries.

![img9.png](img9.png)

3. Tambahkan kode program seperti pada gambar. Pastikan library sudah dipanggil, menambahkan kode program pada setup(), dan pada loop().

![img10.png](img10.png)
![img11.png](img11.png)

4. Rangkai sesuai pada gambar di bawah dengan komunikasi menggunakan I2C. Pastikan komunikasi I2C telah sesuai. Klik Start simulation untuk menjalankan simulasi.
   
![img12.png](img12.png)


## Praktik OLED, DHT ESP dengan Wokwi
+ Kunjungi link project ini untuk melihat implementasi DHT dan OLED di ESP32 -https://wokwi.com/projects/375444707313967105

## Praktik DHT ESP dengan Thonny
+ Skenario

![img14.png](img14.png)
![img15.png](img15.png)
  
+ Berikut code untuk membaca suhu dan kelembaban dengan sensor DHT22

```python
from machine import Pin
from time import sleep_ms
from dht import DHT22

# create dht-sensor instance
dhtSensor = DHT22(Pin(15))  

temperature = 0.0  # variable to save temperature value
humidity = 0.0     # variable to save humidity value

while True:
    dhtSensor.measure() # read sensor measurements
    temperature = dhtSensor.temperature()
    humidity = dhtSensor.humidity()

    print("T: %.1f C" %temperature)  # output temperature value
    print("H: %.1f %%" %humidity)  # output humidity value
    
    sleep_ms(2000); # pause for two seconds (2.000 milliseconds)
```

+ Hasil pembacaan sensor

![img16.png](img16.png)
  
## Tugas Mandiri 
Selesaikan langkah-langkah praktikum berikut ini menggunakan Wokwi di browser Anda.

**Tugas 1**
- Rangkai seusai dengan gambar. Tampilkan nilai suhu dan kelembaban dalam LCD. Tampilkan juga waktu dalam format YYYY/MM/DD HH:mm:ss pada LCD. Contoh: 2024/07/23 08:00:00

![img13.png](img13.png)

**Tugas 2**
- Tambahkan logika, ketika suhu < 20 maka akan tampil di LCD “DINGIN, sedangkan nilai suhu 20 - 50 “BIASA SAJA”, serta jika > 50 akan menampilkan “PANAS”.
Tampilkan juga waktu dalam format YYYY/MM/DD HH:mm:ss pada LCD. Contoh: 2024/07/23 08:00:00


